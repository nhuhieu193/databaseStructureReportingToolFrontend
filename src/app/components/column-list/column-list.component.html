<!-- src/app/components/column-list/column-list.component.html -->
<div *ngIf="table" class="column-list-container">
  <h3>Columns for {{ table.tableName }}</h3>

  <!-- Loading indicator -->
  <div *ngIf="loading" class="loading-indicator">
    <p>Loading...</p>
  </div>

  <!-- Error message -->
  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
    <button class="btn btn-retry" (click)="loadColumns()">Retry</button>
  </div>

  <!-- Table hi·ªÉn th·ªã danh s√°ch columns -->
  <table class="columns-table">
    <thead>
    <tr>
      <th>Column Name</th>
      <th>Data Type</th>
      <th>Size</th>
      <th>Nullable</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let col of columns; trackBy: trackByColumnId">
      <td>{{ col.columnName }}</td>
      <td>
          <span class="data-type-badge" [class]="'type-' + col.dataType.toLowerCase()">
            {{ col.dataType }}
          </span>
      </td>
      <td>{{ col.columnSize || '-' }}</td>
      <td>
          <span class="nullable-indicator" [class.nullable]="col.nullable" [class.not-nullable]="!col.nullable">
            {{ col.nullable ? 'Yes' : 'No' }}
          </span>
      </td>
      <td class="actions">
        <button
          type="button"
          class="btn btn-edit"
          (click)="onEdit(col)"
          [disabled]="loading"
          title="Edit Column">
          ‚úèÔ∏è
        </button>
        <button
          type="button"
          class="btn btn-delete"
          (click)="deleteColumn(col)"
          [disabled]="loading"
          title="Delete Column">
          üóëÔ∏è
        </button>
      </td>
    </tr>

    <!-- Row ƒë·ªÉ th√™m column m·ªõi -->
    <tr class="add-row">
      <td>
        <input
          type="text"
          [(ngModel)]="newCol.columnName"
          placeholder="Column name"
          class="form-input">
      </td>
      <td>
        <select
          [(ngModel)]="newCol.dataType"
          class="form-select">
          <option value="">Select type</option>
          <option value="VARCHAR">VARCHAR</option>
          <option value="TEXT">TEXT</option>
          <option value="INTEGER">INTEGER</option>
          <option value="BIGINT">BIGINT</option>
          <option value="DECIMAL">DECIMAL</option>
          <option value="FLOAT">FLOAT</option>
          <option value="DOUBLE">DOUBLE</option>
          <option value="BOOLEAN">BOOLEAN</option>
          <option value="DATE">DATE</option>
          <option value="DATETIME">DATETIME</option>
          <option value="TIMESTAMP">TIMESTAMP</option>
          <option value="TIME">TIME</option>
          <option value="BLOB">BLOB</option>
          <option value="CLOB">CLOB</option>
        </select>
      </td>
      <td>
        <input
          type="number"
          [(ngModel)]="newCol.columnSize"
          placeholder="Size"
          class="form-input size-input"
          min="0">
      </td>
      <td>
        <input
          type="checkbox"
          [(ngModel)]="newCol.nullable"
          class="form-checkbox">
      </td>
      <td>
        <button
          type="button"
          class="btn btn-add"
          (click)="addColumn()"
          [disabled]="!newCol.columnName.trim() || !newCol.dataType"
          title="Add Column">
          ‚ûï Add
        </button>
      </td>
    </tr>
    </tbody>
  </table>

  <!-- Form Edit Column - Hi·ªÉn th·ªã khi c√≥ editCol -->
  <div *ngIf="editCol" class="edit-form-overlay">
    <div class="edit-form-container">
      <app-column-form
        [column]="editCol"
        [tableName]="table.tableName"
        (saved)="onSaveEdit($event)"
        (cancelled)="onCancelEdit()">
      </app-column-form>
    </div>
  </div>

  <!-- Empty state -->
  <div *ngIf="columns.length === 0" class="empty-state">
    <p>No columns found for this table.</p>
    <p>Use the form above to add the first column.</p>
  </div>
</div>
